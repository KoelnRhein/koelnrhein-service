<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* General Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .dashboard {
            display: none;
        }

        .active {
            display: block;
        }

        /* Card & Header Styles */
        .card {
            background: #fff;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #fff;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 24px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 30px;
            text-align: center;
        }

        /* Form & Button Styles */
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .password-container {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #999;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-right: 10px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn:hover {
            opacity: 0.8;
            transform: translateY(-2px);
        }

        /* Table Styles */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #555;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: capitalize;
        }

        .status-offen { background-color: #fce4ec; color: #c2185b; }
        .status-zugewiesen { background-color: #e3f2fd; color: #1976d2; }
        .status-in_bearbeitung { background-color: #fff3e0; color: #ff8f00; }
        .status-erledigt { background-color: #e8f5e9; color: #388e3c; }

        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .login-card {
            background: #fff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .message {
            padding: 10px;
            margin-top: 15px;
            border-radius: 8px;
        }
        
        .message.success {
            background-color: #d4edda;
            color: #155724;
        }

        .message.error {
            background-color: #f8d7da;
            color: #721c24;
        }

        /* Print-specific styles */
        @media print {
            body { background: none; }
            .dashboard, .header, .card, .table { box-shadow: none; border-radius: 0; }
            .header-actions, .login-container, .btn, #liveLocations, #customersTable, #employeesTable, .btn-group { display: none; }
            .table { width: 100%; border-collapse: collapse; }
            .table th, .table td { border: 1px solid #ccc; }
        }
    </style>
</head>
<body>

<div id="loginScreen" class="active login-container">
    <div class="login-card">
        <div class="logo"><i class="fas fa-tools"></i> Service Manager</div>
        <div class="form-group">
            <label for="userType">Anmelden als:</label>
            <select id="userType" class="form-control">
                <option value="customer">Kunde</option>
                <option value="employee">Mitarbeiter</option>
                <option value="admin">Administrator</option>
            </select>
        </div>
        <div class="form-group">
            <label for="username">E-Mail / ID:</label>
            <input type="text" id="username" class="form-control" placeholder="Ihre E-Mail oder ID">
        </div>
        <div class="form-group">
            <label for="password">Passwort:</label>
            <div class="password-container">
                <input type="password" id="password" class="form-control" placeholder="Ihr Passwort">
                <span class="password-toggle" onclick="togglePasswordVisibility()"><i class="fas fa-eye"></i></span>
            </div>
        </div>
        <button class="btn btn-primary" onclick="login()"><i class="fas fa-sign-in-alt"></i> Anmelden</button>
        <div id="loginMessage" class="message"></div>
        <div style="margin-top: 20px; font-size: 12px; color: #777;">
            <strong>Test-Zugänge:</strong><br>
            Kunde: user@example.com / pass123<br>
            Mitarbeiter: emp001 / pin123<br>
            Admin: admin / admin123
        </div>
    </div>
</div>

<div id="customerDashboard" class="dashboard container">
    <div class="header">
        <h1><i class="fas fa-user-circle"></i> Kunden-Dashboard</h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="showCustomerProfile()"><i class="fas fa-user"></i> Profil</button>
            <button class="btn btn-primary" onclick="printOrders()"><i class="fas fa-print"></i> Meine Aufträge drucken</button>
            <button class="btn btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Abmelden</button>
        </div>
    </div>

    <div class="card">
        <h2>Neuen Auftrag erstellen</h2>
        <div class="form-group">
            <label for="orderTitle">Titel:</label>
            <input type="text" id="orderTitle" class="form-control" placeholder="z.B. Heizungsreparatur">
        </div>
        <div class="form-group">
            <label for="orderDesc">Beschreibung:</label>
            <textarea id="orderDesc" class="form-control" rows="4" placeholder="Detaillierte Beschreibung des Problems"></textarea>
        </div>
        <button class="btn btn-success" onclick="createOrder()"><i class="fas fa-plus-circle"></i> Auftrag erstellen</button>
        <div id="customerOrderMessage" class="message"></div>
    </div>

    <div class="card">
        <h2>Ihre Aufträge</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Auftrags-ID</th>
                    <th>Titel</th>
                    <th>Status</th>
                    <th>Zugewiesen an</th>
                    <th>Erstellt am</th>
                    <th>Erledigt am</th>
                </tr>
            </thead>
            <tbody id="customerOrdersTable">
                </tbody>
        </table>
    </div>
</div>

<div id="employeeDashboard" class="dashboard container">
    <div class="header">
        <h1><i class="fas fa-user-tie"></i> Mitarbeiter-Dashboard</h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="showEmployeeProfile()"><i class="fas fa-user"></i> Profil</button>
            <button class="btn btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Abmelden</button>
        </div>
    </div>

    <div class="card">
        <h2>Zugewiesene Aufträge</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Auftrags-ID</th>
                    <th>Titel</th>
                    <th>Kunde</th>
                    <th>Status</th>
                    <th>Aktionen</th>
                </tr>
            </thead>
            <tbody id="employeeOrdersTable">
                </tbody>
        </table>
    </div>
</div>

<div id="adminDashboard" class="dashboard container">
    <div class="header">
        <h1><i class="fas fa-users-cog"></i> Administrator-Dashboard</h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="showAdminReports()"><i class="fas fa-chart-line"></i> Berichte</button>
            <button class="btn btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Abmelden</button>
        </div>
    </div>

    <div class="card">
        <h2>Benutzer verwalten</h2>
        <button class="btn btn-primary" onclick="showUserManagement()"><i class="fas fa-users-cog"></i> Benutzer verwalten</button>
        <div id="userManagementSection" class="card" style="display:none; margin-top: 15px;">
            <h3>Neuen Benutzer anlegen</h3>
            <div class="form-group">
                <label for="newUserType">Benutzertyp:</label>
                <select id="newUserType" class="form-control">
                    <option value="customer">Kunde</option>
                    <option value="employee">Mitarbeiter</option>
                    <option value="admin">Administrator</option>
                </select>
            </div>
            <div class="form-group">
                <label for="newUserName">Name:</label>
                <input type="text" id="newUserName" class="form-control">
            </div>
            <div id="newUserIdGroup" class="form-group">
                <label for="newUserId">ID (Mitarbeiter/Admin):</label>
                <input type="text" id="newUserId" class="form-control">
            </div>
            <div id="newUserEmailGroup" class="form-group">
                <label for="newUserEmail">E-Mail (Kunde):</label>
                <input type="email" id="newUserEmail" class="form-control">
            </div>
            <div class="form-group">
                <label for="newUserPassword">Passwort/PIN:</label>
                <input type="password" id="newUserPassword" class="form-control">
            </div>
            <button class="btn btn-success" onclick="createNewUser()">Benutzer anlegen</button>
            <div id="userMessage" class="message"></div>
        </div>
    </div>

    <div class="card">
        <h2>Passwort ändern</h2>
        <div class="form-group">
            <label for="currentPassword">Aktuelles Passwort:</label>
            <input type="password" id="currentPassword" class="form-control">
        </div>
        <div class="form-group">
            <label for="newPassword">Neues Passwort:</label>
            <input type="password" id="newPassword" class="form-control">
        </div>
        <div class="form-group">
            <label for="confirmNewPassword">Neues Passwort bestätigen:</label>
            <input type="password" id="confirmNewPassword" class="form-control">
        </div>
        <button class="btn btn-warning" onclick="changeAdminPassword()">Passwort ändern</button>
        <div id="passwordMessage" class="message"></div>
    </div>

    <div class="card">
        <h2>Aufträge verwalten</h2>
        <div class="header-actions" style="justify-content: flex-start; margin-bottom: 10px;">
            <button class="btn btn-primary" onclick="printOrders()"><i class="fas fa-print"></i> Bericht drucken</button>
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Titel</th>
                    <th>Kunde</th>
                    <th>Status</th>
                    <th>Notizen</th>
                    <th>Zugewiesen an</th>
                    <th>Aktionen</th>
                </tr>
            </thead>
            <tbody id="adminOrdersTable">
                </tbody>
        </table>
    </div>

    <div class="card">
        <h2>Live-Standorte</h2>
        <div id="liveLocations" style="margin-top: 15px;">
            </div>
    </div>
</div>

<script>
    // In-memory data storage (simulating a database)
    let customers = [
        { id: 'cust001', name: 'Max Mustermann', email: 'user@example.com', password: 'pass123' }
    ];
    let employees = [
        { id: 'emp001', name: 'Anna Schmidt', pin: 'pin123', location: null, status: 'verfügbar' }
    ];
    let orders = [
        { 
            id: 'ord001', 
            customerId: 'cust001', 
            title: 'Wasserhahn defekt', 
            description: 'Der Wasserhahn in der Küche tropft unaufhörlich.', 
            status: 'offen', 
            assignedTo: null, 
            notes: '',
            createdAt: new Date().toLocaleString()
        }
    ];
    let admin = {
        password: 'admin123'
    };

    // Current user state
    let currentUser = null;
    let userRole = null;
    let locationInterval = null;

    // Helper functions
    function showSection(sectionId) {
        document.querySelectorAll('div.dashboard, div.login-container').forEach(el => el.classList.remove('active'));
        document.getElementById(sectionId).classList.add('active');
    }

    function showMessage(elementId, message, type) {
        const el = document.getElementById(elementId);
        el.textContent = message;
        el.className = `message ${type}`;
        setTimeout(() => el.textContent = '', 3000);
    }

    function generateRandomLocation() {
        return {
            lat: 50.9375 + (Math.random() - 0.5) * 0.05,
            lng: 6.9603 + (Math.random() - 0.5) * 0.05
        };
    }
    
    function togglePasswordVisibility() {
        const passwordInput = document.getElementById('password');
        const toggleIcon = document.querySelector('.password-toggle i');
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleIcon.className = 'fas fa-eye-slash';
        } else {
            passwordInput.type = 'password';
            toggleIcon.className = 'fas fa-eye';
        }
    }

    // Login/Logout Logic
    function login() {
        const userType = document.getElementById('userType').value;
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();
        
        document.getElementById('password').type = 'password';
        document.querySelector('.password-toggle i').className = 'fas fa-eye';

        let user = null;

        if (userType === 'customer') {
            user = customers.find(c => c.email === username && c.password === password);
        } else if (userType === 'employee') {
            user = employees.find(e => e.id === username && e.pin === password);
        } else if (userType === 'admin') {
            if (username === 'admin' && password === admin.password) {
                user = { id: 'admin', name: 'Administrator' };
            }
        }

        if (user) {
            currentUser = user;
            userRole = userType;
            if (userRole === 'customer') {
                showSection('customerDashboard');
                loadCustomerOrders();
            } else if (userRole === 'employee') {
                showSection('employeeDashboard');
                loadEmployeeOrders();
            } else if (userRole === 'admin') {
                showSection('adminDashboard');
                loadAdminOrders();
                startLiveTracking();
            }
        } else {
            showMessage('loginMessage', 'Ungültige Anmeldedaten.', 'error');
        }
    }

    function logout() {
        currentUser = null;
        userRole = null;
        clearInterval(locationInterval);
        showSection('loginScreen');
    }

    // --- New/Updated Functions ---
    function showCustomerProfile() {
        alert('Kundenprofil-Ansicht: Hier würden die persönlichen Daten angezeigt werden.');
    }

    function showEmployeeProfile() {
        alert('Mitarbeiterprofil-Ansicht: Hier würden die persönlichen Daten und Arbeitszeiten angezeigt werden.');
    }

    function showAdminReports() {
        alert('Berichte-Ansicht: Hier würden Übersichten über Aufträge, Mitarbeiter und Umsätze angezeigt werden.');
    }

    function printOrders() {
        window.print();
    }

    function changeAdminPassword() {
        const currentPass = document.getElementById('currentPassword').value.trim();
        const newPass = document.getElementById('newPassword').value.trim();
        const confirmPass = document.getElementById('confirmNewPassword').value.trim();

        if (currentPass !== admin.password) {
            showMessage('passwordMessage', 'Aktuelles Passwort ist falsch.', 'error');
            return;
        }

        if (newPass.length < 5) {
            showMessage('passwordMessage', 'Neues Passwort muss mindestens 5 Zeichen haben.', 'error');
            return;
        }

        if (newPass !== confirmPass) {
            showMessage('passwordMessage', 'Neue Passwörter stimmen nicht überein.', 'error');
            return;
        }

        admin.password = newPass;
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmNewPassword').value = '';
        showMessage('passwordMessage', 'Passwort erfolgreich geändert!', 'success');
    }

    function showUserManagement() {
        const section = document.getElementById('userManagementSection');
        section.style.display = section.style.display === 'block' ? 'none' : 'block';
    }

    function createNewUser() {
        const userType = document.getElementById('newUserType').value;
        const name = document.getElementById('newUserName').value.trim();
        const password = document.getElementById('newUserPassword').value.trim();

        if (userType === 'customer') {
            const email = document.getElementById('newUserEmail').value.trim();
            if (!name || !email || !password) {
                showMessage('userMessage', 'Bitte alle Felder ausfüllen.', 'error');
                return;
            }
            const newCustomer = {
                id: 'cust' + (customers.length + 1).toString().padStart(3, '0'),
                name: name,
                email: email,
                password: password
            };
            customers.push(newCustomer);
            showMessage('userMessage', 'Kunde erfolgreich angelegt!', 'success');
        } else {
            const id = document.getElementById('newUserId').value.trim();
            if (!name || !id || !password) {
                showMessage('userMessage', 'Bitte alle Felder ausfüllen.', 'error');
                return;
            }
            if (userType === 'employee') {
                const newEmployee = {
                    id: id,
                    name: name,
                    pin: password,
                    location: null,
                    status: 'verfügbar'
                };
                employees.push(newEmployee);
                showMessage('userMessage', 'Mitarbeiter erfolgreich angelegt!', 'success');
            } else if (userType === 'admin') {
                admin = {
                    id: id,
                    name: name,
                    password: password
                };
                showMessage('userMessage', 'Administrator erfolgreich angelegt! (Überschreibt alten Admin)', 'success');
            }
        }
        
        // Clear inputs
        document.getElementById('newUserName').value = '';
        document.getElementById('newUserPassword').value = '';
        document.getElementById('newUserId').value = '';
        document.getElementById('newUserEmail').value = '';
    }

    document.getElementById('newUserType').addEventListener('change', (event) => {
        const userType = event.target.value;
        document.getElementById('newUserIdGroup').style.display = userType === 'customer' ? 'none' : 'block';
        document.getElementById('newUserEmailGroup').style.display = userType === 'customer' ? 'block' : 'none';
        document.getElementById('newUserPassword').type = userType === 'employee' ? 'text' : 'password';
    });
    // Initial state
    document.getElementById('newUserIdGroup').style.display = 'none';

    // Customer Functions
    function createOrder() {
        const title = document.getElementById('orderTitle').value;
        const description = document.getElementById('orderDesc').value;

        if (!title || !description) {
            showMessage('customerOrderMessage', 'Bitte alle Felder ausfüllen.', 'error');
            return;
        }

        const newOrder = {
            id: 'ord' + (orders.length + 1).toString().padStart(3, '0'),
            customerId: currentUser.id,
            title,
            description,
            status: 'offen',
            assignedTo: null,
            notes: '',
            createdAt: new Date().toLocaleString(),
            assignedAt: null,
            startedAt: null,
            completedAt: null
        };
        orders.push(newOrder);

        document.getElementById('orderTitle').value = '';
        document.getElementById('orderDesc').value = '';
        showMessage('customerOrderMessage', 'Auftrag erfolgreich erstellt!', 'success');
        loadCustomerOrders();
    }

    function loadCustomerOrders() {
        const tableBody = document.getElementById('customerOrdersTable');
        tableBody.innerHTML = '';
        const userOrders = orders.filter(o => o.customerId === currentUser.id);

        userOrders.forEach(order => {
            const row = document.createElement('tr');
            const assignedEmployee = employees.find(e => e.id === order.assignedTo);
            const assignedName = assignedEmployee ? assignedEmployee.name : 'Nicht zugewiesen';
            const statusClass = `status-${order.status.replace(' ', '_')}`;
            row.innerHTML = `
                <td>${order.id}</td>
                <td>${order.title}</td>
                <td><span class="status-badge ${statusClass}">${order.status}</span></td>
                <td>${assignedName}</td>
                <td>${order.createdAt}</td>
                <td>${order.completedAt || 'N/A'}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Employee Functions
    function loadEmployeeOrders() {
        const tableBody = document.getElementById('employeeOrdersTable');
        tableBody.innerHTML = '';
        const userOrders = orders.filter(o => o.assignedTo === currentUser.id);

        userOrders.forEach(order => {
            const customer = customers.find(c => c.id === order.customerId);
            const statusClass = `status-${order.status.replace(' ', '_')}`;
            
            let actions = '';
            if (order.status === 'zugewiesen') {
                actions = `<button class="btn btn-success" onclick="updateOrderStatus('${order.id}', 'in_bearbeitung')"><i class="fas fa-play"></i> Starten</button>`;
            } else if (order.status === 'in_bearbeitung') {
                actions = `<button class="btn btn-primary" onclick="updateOrderStatus('${order.id}', 'erledigt')"><i class="fas fa-check"></i> Erledigen</button>`;
            }

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${order.id}</td>
                <td>${order.title}</td>
                <td>${customer.name}</td>
                <td><span class="status-badge ${statusClass}">${order.status}</span></td>
                <td>${actions}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    function updateOrderStatus(orderId, newStatus) {
        const order = orders.find(o => o.id === orderId);
        if (order) {
            order.status = newStatus;
            if (newStatus === 'in_bearbeitung') {
                order.startedAt = new Date().toLocaleString();
            } else if (newStatus === 'erledigt') {
                order.completedAt = new Date().toLocaleString();
            }
            loadEmployeeOrders(); // Refresh table
            loadAdminOrders(); // Also refresh admin view for live updates
        }
    }

    // Admin Functions
    function loadAdminOrders() {
        const tableBody = document.getElementById('adminOrdersTable');
        tableBody.innerHTML = '';
        orders.forEach(order => {
            const customer = customers.find(c => c.id === order.customerId);
            const assignedEmployee = employees.find(e => e.id === order.assignedTo);
            const statusClass = `status-${order.status.replace(' ', '_')}`;
            
            const actions = `
                <button class="btn btn-warning btn-sm" onclick="editOrderNotes('${order.id}')" title="Notizen bearbeiten">
                    <i class="fas fa-edit"></i>
                </button>
                <select onchange="assignEmployee('${order.id}', this.value)">
                    <option value="">Zuweisen...</option>
                    ${employees.map(e => `<option value="${e.id}" ${order.assignedTo === e.id ? 'selected' : ''}>${e.name}</option>`).join('')}
                </select>
                ${order.status === 'erledigt' ? `<button class="btn btn-danger btn-sm" onclick="deleteOrder('${order.id}')" title="Auftrag löschen"><i class="fas fa-trash"></i></button>` : ''}
            `;

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${order.id}</td>
                <td>${order.title}</td>
                <td>${customer ? customer.name : 'N/A'}</td>
                <td><span class="status-badge ${statusClass}">${order.status}</span></td>
                <td title="${order.notes}">${order.notes.substring(0, 20)}${order.notes.length > 20 ? '...' : ''}</td>
                <td>${assignedEmployee ? assignedEmployee.name : 'Keiner'}</td>
                <td>${actions}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    function assignEmployee(orderId, employeeId) {
        const order = orders.find(o => o.id === orderId);
        if (order) {
            order.assignedTo = employeeId;
            order.status = 'zugewiesen';
            order.assignedAt = new Date().toLocaleString();
            loadAdminOrders();
            console.log(`Auftrag ${orderId} wurde Mitarbeiter ${employeeId} zugewiesen.`);
        }
    }

    function editOrderNotes(orderId) {
        const order = orders.find(o => o.id === orderId);
        if (order) {
            const newNotes = prompt("Notizen bearbeiten:", order.notes);
            if (newNotes !== null) {
                order.notes = newNotes;
                loadAdminOrders();
            }
        }
    }

    function deleteOrder(orderId) {
        if (confirm('Sind Sie sicher, dass Sie diesen Auftrag löschen möchten?')) {
            orders = orders.filter(order => order.id !== orderId);
            loadAdminOrders();
        }
    }

    function startLiveTracking() {
        if (locationInterval) {
            clearInterval(locationInterval);
        }
        locationInterval = setInterval(() => {
            employees.forEach(emp => {
                if (emp.status === 'in_bearbeitung' || emp.status === 'unterwegs') {
                    emp.location = generateRandomLocation();
                } else {
                    emp.location = null;
                }
            });
            updateLiveLocations();
        }, 5000); // Update every 5 seconds
    }

    function updateLiveLocations() {
        const container = document.getElementById('liveLocations');
        container.innerHTML = '<h4>Aktuelle Mitarbeiter-Standorte:</h4>';
        const activeEmployees = employees.filter(e => e.location);
        if (activeEmployees.length === 0) {
            container.innerHTML += '<p>Derzeit sind keine Mitarbeiter aktiv.</p>';
            return;
        }

        activeEmployees.forEach(emp => {
            container.innerHTML += `
                <div class="card" style="padding: 15px; margin-bottom: 10px;">
                    <strong>${emp.name}</strong> (${emp.status})<br>
                    <small>Lat: ${emp.location.lat.toFixed(4)}, Lng: ${emp.location.lng.toFixed(4)}</small>
                </div>
            `;
        });
    }
</script>

</body>
</html>
